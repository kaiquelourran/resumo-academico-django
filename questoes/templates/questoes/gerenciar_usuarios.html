{% extends 'questoes/base.html' %}
{% load static %}

{% block title %}Gerenciar Usu√°rios - Admin{% endblock %}

{% block extra_css %}
<style>
    body { 
        background-image: linear-gradient(to top, #00C6FF, #0072FF); 
        margin:0; 
        min-height:100vh; 
    }
    
    .admin-container { 
        max-width:1100px; 
        margin:40px auto; 
        background:#fff; 
        border-radius:16px; 
        box-shadow:0 20px 40px rgba(0,0,0,.1); 
        padding:24px; 
    }
    
    .header-row { 
        display:flex; 
        gap:12px; 
        align-items:center; 
        justify-content:space-between; 
        margin-bottom:16px; 
        flex-wrap: wrap;
    }
    
    .search-box { 
        display:flex; 
        gap:8px; 
    }
    
    .search-box input { 
        padding:10px 12px; 
        border:1px solid #e5e7eb; 
        border-radius:10px; 
        min-width:260px; 
    }
    
    .table { 
        width:100%; 
        border:1px solid #e9ecef; 
        border-radius:12px; 
        overflow:hidden; 
    }
    
    .thead { 
        display:grid; 
        grid-template-columns:2fr 2fr 1fr 1fr 1.5fr; 
        gap:12px; 
        padding:14px 16px; 
        background:linear-gradient(135deg,#0072FF,#00C6FF); 
        color:#fff; 
        font-weight:700; 
    }
    
    .row { 
        display:grid; 
        grid-template-columns:2fr 2fr 1fr 1fr 1.5fr; 
        gap:12px; 
        padding:12px 16px; 
        border-bottom:1px solid #e9ecef; 
        align-items:center; 
    }
    
    .row:last-child { 
        border-bottom:none; 
    }
    
    .name { 
        display:flex; 
        gap:10px; 
        align-items:center; 
    }
    
    .avatar { 
        width:32px; 
        height:32px; 
        border-radius:50%; 
        background:linear-gradient(135deg,#0072FF,#00C6FF); 
        color:#fff; 
        display:flex; 
        align-items:center; 
        justify-content:center; 
        font-weight:700; 
    }
    
    .pagination { 
        margin-top:16px; 
        display:flex; 
        justify-content:center; 
        gap:8px; 
    }
    
    .page { 
        padding:8px 12px; 
        border-radius:8px; 
        border:1px solid #e5e7eb; 
        background:#fff; 
        text-decoration:none; 
        color:#0f172a; 
    }
    
    .page.active { 
        background:linear-gradient(135deg,#0072FF,#00C6FF); 
        color:#fff; 
        border-color:#cfe2ff; 
    }
    
    @media (max-width: 768px) {
        .thead, .row { 
            grid-template-columns: 1fr; 
        }
        
        .thead { 
            display:none; 
        }
        
        .row { 
            border:1px solid #e9ecef; 
            border-radius:10px; 
            margin-bottom:10px; 
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="admin-container">
    <div class="header-row">
        <h2 style="margin:0;">üë• Gerenciar Usu√°rios</h2>
        <div class="search-box">
            <form method="get" action="">
                <input type="text" name="q" value="{{ query }}" placeholder="Buscar por nome ou email...">
                <button class="btn btn-primary" type="submit">Buscar</button>
            </form>
            <a href="{% url 'questoes:admin_dashboard' %}" class="btn btn-secondary">Voltar</a>
        </div>
    </div>

    <div class="table">
        <div class="thead">
            <div>Nome</div>
            <div>Email</div>
            <div>Tipo</div>
            <div>Cadastro</div>
            <div>√öltimo Login</div>
        </div>
        <div>
            {% if usuarios %}
                {% for usuario in usuarios %}
                    <div class="row">
                        <div class="name">
                            <div class="avatar">{{ usuario.first_name|default:usuario.username|first|upper }}</div>
                            <span>{{ usuario.first_name|default:usuario.username }}</span>
                        </div>
                        <div>{{ usuario.email }}</div>
                        <div>
                            <span class="type-badge {% if usuario.is_staff %}admin{% else %}user{% endif %}">
                                {% if usuario.is_staff %}üëë Admin{% else %}üë§ Usu√°rio{% endif %}
                            </span>
                        </div>
                        <div>{{ usuario.date_joined|date:"d/m/Y" }}</div>
                        <div>N/A</div>
                    </div>
                {% endfor %}
            {% else %}
                <div class="row">
                    <div style="grid-column: 1/-1; text-align:center; color:#666;">Nenhum usu√°rio encontrado.</div>
                </div>
            {% endif %}
        </div>
    </div>

    <div class="pagination">
        {% if is_paginated %}
            {% if page_obj.has_previous %}
                <a class="page" href="?q={{ query }}&page={{ page_obj.previous_page_number }}">‚Üê</a>
            {% endif %}
            
            {% for p in page_obj.paginator.page_range %}
                <a class="page {% if p == page_obj.number %}active{% endif %}" href="?q={{ query }}&page={{ p }}">{{ p }}</a>
            {% endfor %}
            
            {% if page_obj.has_next %}
                <a class="page" href="?q={{ query }}&page={{ page_obj.next_page_number }}">‚Üí</a>
            {% endif %}
        {% endif %}
    </div>
</div>
{% endblock %}




